<!DOCTYPE html>
<html>
    <head>
	<meta charset="utf-8">
	<title>UTM conversion demo</title>

	<style type="text/css">
	    .error { color: red; }
	</style>
	
	<script type="text/javascript" src="utmconv.js"></script>
	<script type="text/javascript" src="output.js"></script>

	<script type="text/javascript">
/*jslint browser: true, vars: true, white: true */
/*global UTMConv: false, Output: false */

	    var output = new Output("output", "error");

	    // Get integer text field with error checking.
	    function get_int(id, what) {
		"use strict";
		var s = document.getElementById(id).value;
		var val = parseInt(s, 10);
		if (isNaN(val)) {
		    throw new Error(what + " not recognized as integer: '" + s + "'");
		}
		return val;
	    }

	    // Get float text field with error checking.
	    function get_float(id, what) {
		"use strict";
		var s = document.getElementById(id).value;
		var val = parseFloat(s);
		if (isNaN(val)) {
		    throw new Error(what + " not recognized as floating-point number: '" + s + "'");
		}
		return val;
	    }

	    function conv_geo_to_utm() {
		"use strict";
		try {
		    var latdir = document.getElementById("latdir").value;
		    var latdeg = get_int("latdeg", "latitude degrees");
		    var latmin = get_float("latmin", "latitude minutes");
		    var lngdir = document.getElementById("lngdir").value;
		    var lngdeg = get_int("lngdeg", "longitude degrees");
		    var lngmin = get_float("lngmin", "longitude minutes");

		    var degmin = new UTMConv.DegMinCoords(latdir, latdeg, latmin, lngdir, lngdeg, lngmin);
		    var utm = degmin.to_deg().to_utm();

		    var frag = output.newFrag();
		    frag.writeln_head(degmin);
		    frag.writeln(utm);
		    frag.writeln(" ");
		    output.writeFrag(frag);

		    return true;
		}
		catch (e) {
		    output.errorln("Error: " + e.message);
		    return false;
		}
	    }

	    function conv_utm_to_geo() {
		"use strict";
		try {
		    var utmz = get_int("utmz", "UTM zone");
		    var easting = get_float("easting", "UTM easting");
		    var northing = get_float("northing", "UTM northing");

		    var utm = new UTMConv.UTMCoords(utmz, easting, northing);
		    var degmin = utm.to_deg().to_degmin();

		    var frag = output.newFrag();
		    frag.writeln_head(utm);
		    frag.writeln(degmin);
		    frag.writeln(" ");
		    output.writeFrag(frag);

		    return true;
		}
		catch (e) {
		    output.errorln("Error: " + e.message);
		    return false;
		}
	    }

	    function init() {
		"use strict";
		output.clearOutput();
		document.getElementById("geo_to_utm_form").onsubmit = function () { conv_geo_to_utm(); return false; };
		document.getElementById("utm_to_geo_form").onsubmit = function () { conv_utm_to_geo(); return false; };
		document.getElementById("clear_btn").onclick = function () { output.clearOutput(); };
	    }

	    window.onload = init;
	</script>
    </head>

    <body>
	<noscript>
	    <span class="error">
		This web page requires a browser that supports Javascript.<br />Your browser either does not support Javascript or it has Javascript disabled. Please upgrade your browser or enable Javascript support.<br />&nbsp;<br />
	    </span>
	</noscript>

	<h1>UTM conversion demo</h1>
	<form id="geo_to_utm_form" action="#">
	    Enter dd mm.mmm coordinates here to get UTM coordinates below:<br />

	    <select id="latdir"><option value="N" selected="selected">N</option><option value="S">S</option></select>
	    <input type="text" id="latdeg" size="5" value="40" onfocus="select();" />
	    <input type="text" id="latmin" size="10" value="30.0" onfocus="select();" />
	    <br />

	    <select id="lngdir"><option value="W" selected="selected">W</option><option value="E">E</option></select>
	    <input type="text" id="lngdeg" size="5" value="73" onfocus="select();" />
	    <input type="text" id="lngmin" size="10" value="30.0" onfocus="select();" />
	    <br />

	    <input type="submit" value="Convert it" />&nbsp;
	</form>

	<hr />

	<form id="utm_to_geo_form" action="#">
	    Enter UTM coordinates here to get dd mm.mmm coordinates below:<br />

	    <input type="text" id="utmz" size="4" value="18" onfocus="select();" />
	    <input type="text" id="easting" size="20" value="627103.1" onfocus="select();" />
	    <input type="text" id="northing" size="20" value="4484335.4" onfocus="select();" />
	    <br />

	    <input type="submit" value="Convert it" />&nbsp;
	</form>

	<hr />

	<form action="#">
	    <input type="button" id="clear_btn" value="Clear results" />
	</form>

	<hr />
	<br />
	<div id="output"></div>
    </body>
</html>
<!-- vim:set tw=0: -->
